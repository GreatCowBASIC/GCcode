(()=>{var e={155:e=>{var t,i,r=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var a,c=[],h=!1,u=-1;function l(){h&&a&&(h=!1,a.length?c=a.concat(c):u=-1,c.length&&d())}function d(){if(!h){var e=o(l);h=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new p(e,t)),1!==c.length||h||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},29:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(496),n=i(373),s=i(371);t.default=class{constructor(e,t){this._customEditor=!0,this._disposed=!1,this._disposables=[],this._uri=t,this._scriptUri=n.Utils.joinPath(e.extensionUri,"out"),this._storage=e.workspaceState,s.documentViewManager.add(this)}initWebviewPanel(e){let t=`Preview '${n.Utils.basename(this._uri)}'`,i=r.window.createWebviewPanel(this.viewType,t,e,{enableScripts:!0,enableCommandUris:!0,enableFindWidget:!0,retainContextWhenHidden:!0});return this.attachWebviewPanel(i)}attachWebviewPanel(e){return this._customEditor=!1,this._panel=e,this._previewUri=e.webview.asWebviewUri(this._uri),this._scriptUri=e.webview.asWebviewUri(this._scriptUri),this._panel.onDidDispose((()=>{this.dispose()}),this,this._disposables),this}initialize(){this.webview.onDidReceiveMessage((e=>{e.save?this.state=e.state:e.refresh?this.refresh():e.error&&r.window.showErrorMessage(e.error)}),this,this._disposables),r.workspace.onDidChangeTextDocument((e=>{this._disposed||e.document.uri.toString()!==this.uri.toString()||this.refresh()}),this,this._disposables),this.webview.html=this.getHtml()}dispose(){for(s.documentViewManager.remove(this),this._disposed=!0;this._disposables.length;){const e=this._disposables.pop();e&&e.dispose()}}configure(){this.configurable&&(this.webview.html=this.getHtml(),this.refresh())}reload(){this.webview.html=this.getHtml(!0)}reveal(){this._panel.reveal()}get hasCustomEditor(){return this._customEditor}get visible(){return this._panel.visible}get webview(){return this._panel.webview}get panel(){return this._panel}set panel(e){this._previewUri=e.webview.asWebviewUri(this._uri),this._scriptUri=e.webview.asWebviewUri(this._scriptUri),this._panel=e,e.webview.options={enableScripts:!0,enableCommandUris:!0},this._panel.onDidDispose((()=>{this.dispose()}),this,this._disposables)}set scheme(e){this._previewUri=this._uri.with({scheme:e})}get uri(){return this._uri}get previewUri(){return this._previewUri}get scriptUri(){return this._scriptUri}get state(){let e=this.previewUri.toString();return this._storage.get(e,null)}set state(e){let t=this.previewUri.toString();this._storage.update(t,e)}clearState(){this.state=null,this.reload(),this.refresh()}}},341:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(496),s=i(29),o=i(712);class a extends s.default{static create(e,t,i){let r=new a(e,t);return r.scheme="csv-preview",r.initWebviewPanel(i),r.initialize(),r}static revive(e,t,i){let r=new a(e,t);return r.scheme="csv-preview",r.attachWebviewPanel(i),r.initialize(),r}getOptions(){let e=this,t=n.workspace.getConfiguration("csv-preview"),i=t.get("separator"),r=this.languageId;if(!r){let e=n.window.activeTextEditor;e&&e.document&&(r=e.document.languageId,this.languageId=r)}if(!r){let t=n.workspace.textDocuments.find((t=>t.uri.toString()===e.uri.toString()));t&&(r=t.languageId,this.languageId=r)}return"tsv"===r?i="\t":"csv (semicolon)"===r?i=";":"csv (pipe)"===r&&(i="\\|"),this.separator&&(i=this.separator),{separator:i,languageId:r,quoteMark:t.get("quoteMark"),hasHeaders:t.get("hasHeaders"),capitalizeHeaders:t.get("capitalizeHeaders"),resizeColumns:t.get("resizeColumns"),lineNumbers:t.get("lineNumbers"),commentCharacter:t.get("commentCharacter"),skipComments:t.get("skipComments"),formatValues:t.get("formatValues"),numberFormat:t.get("numberFormat"),customEditor:this.hasCustomEditor,uri:this.uri.toString(),previewUri:this.previewUri.toString(),state:this.state}}editRow(e){let t=this.getOptions(),i=t.separator,r=t.quoteMark,s=t.hasHeaders?1:0;this.separator&&s++,this._currentRange=new n.Range(e+s,0,e+s+1,0);let o=this._document.getText(this._currentRange),a=this.endOfLine();o.endsWith(a)&&(o=o.substring(0,o.length-a.length));let c=new RegExp(`${i}(?=(?:[^${r}]*${r}[^${r}]*${r})*[^${r}]*$)`);this._currentRow=o.split(new RegExp(c))}setCellValue(e,t,i){let r=this.getOptions(),n=r.separator,s=r.quoteMark;this._currentRow||this.editRow(e);let o=new RegExp(n);this._currentRow[t]=o.exec(i)?`${s}${i}${s}`:i}deleteRows(e){let t=this.getOptions().hasHeaders?1:0;this.separator&&t++,e.forEach((e=>{let i=new n.Range(e+t,0,e+t+1,0);this._wsEdit.delete(this.uri,i)}),this)}singleSeparator(e){return e.startsWith("[")||e.startsWith("\\")?e.slice(1,2):e}endOfLine(){return this._document.eol===n.EndOfLine.CRLF?"\r\n":"\n"}appendRow(e){let t=this.getOptions().separator,i=this.singleSeparator(t).repeat(e-1),r=this._document.lineCount-1,s=this._document.lineAt(r);s.isEmptyOrWhitespace||(this.beginEdit(),this._wsEdit.insert(this.uri,s.range.end,this.endOfLine()),r++),this._currentRange=new n.Range(r,0,r,0),this._currentRow=i.split(new RegExp(t))}beginEdit(){this._wsEdit||(this._wsEdit=new n.WorkspaceEdit)}endEdit(e){return r(this,void 0,void 0,(function*(){if(this._wsEdit){if(this._currentRow){let e=this.singleSeparator(this.getOptions().separator);this._wsEdit.replace(this.uri,this._currentRange,this._currentRow.join(e)+this.endOfLine())}yield n.workspace.applyEdit(this._wsEdit),this._wsEdit=void 0,this._currentRange=void 0,this._currentRow=void 0,e&&this.refresh()}}))}enableEditing(e){this._document=e,this.webview.onDidReceiveMessage((e=>{e.cellEditEnded?(this.beginEdit(),this.setCellValue(e.row,e.col,e.value)):e.rowEditEnded?this.endEdit():e.deleteRows?(this.beginEdit(),this.deleteRows(e.rows),this.endEdit()):e.separator?this.separator=e.separator:e.rowAdded&&this.appendRow(e.count)}),this,this._disposables)}refresh(){if(this._wsEdit)return;let e=this;n.workspace.openTextDocument(this.uri).then((t=>{e._disposed||e.webview.postMessage({refresh:!0,content:t.getText()})}),(e=>{n.window.showInformationMessage(e.message)}))}getHtml(e=!1){return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n        <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${this.webview.cspSource} 'unsafe-inline'; script-src ${this.webview.cspSource} 'unsafe-inline';">\n            <link href="${this.scriptUri}/styles/wijmo.min.css" rel="stylesheet" type="text/css" />\n            <link href="${this.scriptUri}/styles/vscode.css" rel="stylesheet" type="text/css" />\n        </head>\n        <script src="${this.scriptUri}/controls/wijmo.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.input.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.filter.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/csv.js"><\/script>\n        <body style="padding:0px; overflow:hidden" onload="resizeGrid()" onresize="resizeGrid()">\n            <div id="flex"></div>\n        </body>\n        <script type="text/javascript">\n            wijmo.setLicenseKey("${(0,o.getLicenseKey)()}");\n            function ignoreState() {\n                return ${e};\n            }\n            function getOptions() {\n                return ${JSON.stringify(this.getOptions())};\n            }\n            handleEvents();\n            initPage();\n        <\/script>\n        </html>`}get viewType(){return"gc-excelviewer-csv-preview"}get configurable(){return!0}}t.default=a},516:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CsvEditorProvider=void 0;const n=i(496),s=i(341);class o{constructor(e){this.context=e}static register(e){const t=new o(e);return n.window.registerCustomEditorProvider(o.viewType,t,{webviewOptions:{enableFindWidget:!0,retainContextWhenHidden:!0}})}resolveCustomTextEditor(e,t,i){return r(this,void 0,void 0,(function*(){let i=new s.default(this.context,e.uri);i.languageId=e.languageId,i.panel=t,i.initialize(),i.enableEditing(e)}))}}t.CsvEditorProvider=o,o.viewType="gc-excelviewer-csv-editor"},912:(e,t)=>{"use strict";function i(e){for(;e.length;){const t=e.pop();t&&t.dispose()}}Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=t.disposeAll=void 0,t.disposeAll=i,t.Disposable=class{constructor(){this._isDisposed=!1,this._disposables=[]}dispose(){this._isDisposed||(this._isDisposed=!0,i(this._disposables))}_register(e){return this._isDisposed?e.dispose():this._disposables.push(e),e}get isDisposed(){return this._isDisposed}}},371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.documentViewManager=t.DocumentViewManager=void 0;class i{constructor(){this._views=[]}static get Instance(){return this._instance||(this._instance=new this)}add(e){this._views.push(e)}remove(e){let t=this._views.indexOf(e);t>=0&&this._views.splice(t,1)}find(e){return this._views.find((t=>t.previewUri.toString()===t.webview.asWebviewUri(e).toString()))}filter(e){return this._views.filter((t=>t.previewUri.toString()===t.webview.asWebviewUri(e).toString()))}active(){return this._views.find((e=>e.visible))}configure(){this._views.forEach((e=>e.configure()))}}t.DocumentViewManager=i,t.documentViewManager=i.Instance},920:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(496),n=i(29),s=i(712);class o extends n.default{static create(e,t,i){let r=new o(e,t);return r.scheme="excel-preview",r.initWebviewPanel(i),r.initialize(),r}static revive(e,t,i){let r=new o(e,t);return r.scheme="excel-preview",r.attachWebviewPanel(i),r.initialize(),r}getOptions(){return{customEditor:this.hasCustomEditor,uri:this.uri.toString(),previewUri:this.previewUri.toString(),state:this.state}}enableEditing(e){this._document=e,this.webview.onDidReceiveMessage((e=>{e.changed&&this._document.change(e.reason)}),this,this._disposables)}refresh(){let e=this;r.workspace.fs.readFile(this.uri).then((t=>{e.webview.postMessage({refresh:!0,content:t})}),(e=>{r.window.showInformationMessage(e)}))}undo(){this.webview.postMessage({undo:!0})}redo(){this.webview.postMessage({redo:!0})}getHtml(e=!1){return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n        <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src ${this.webview.cspSource} 'unsafe-inline'; script-src ${this.webview.cspSource} 'unsafe-inline';">\n            <link href="${this.scriptUri}/styles/wijmo.min.css" rel="stylesheet" type="text/css" />\n            <link href="${this.scriptUri}/styles/vscode.css" rel="stylesheet" type="text/css" />\n        </head>\n        <script src="${this.scriptUri}/controls/wijmo.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.input.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.filter.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.sheet.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.grid.xlsx.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/controls/wijmo.xlsx.min.js" type="text/javascript"><\/script>\n        <script src="${this.scriptUri}/jszip.min.js"><\/script>\n        <script src="${this.scriptUri}/excel.js"><\/script>\n        <body style="padding:0px; overflow:hidden" onload="resizeSheet()" onresize="resizeSheet()">\n            <div id="sheet"></div>\n        </body>\n        <script type="text/javascript">\n            wijmo.setLicenseKey("${(0,s.getLicenseKey)()}");\n            function ignoreState() {\n                return ${e};\n            }\n            function getOptions() {\n                return ${JSON.stringify(this.getOptions())};\n            }\n            handleEvents();\n            initPage();\n        <\/script>\n        </html>`}get viewType(){return"gc-excelviewer-excel-preview"}get configurable(){return!1}}t.default=o},646:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelDocument=t.ExcelEditorProvider=void 0;const n=i(496),s=i(912),o=i(920),a=i(371);class c{constructor(e){this.context=e,this._onDidChangeCustomDocument=new n.EventEmitter,this.onDidChangeCustomDocument=this._onDidChangeCustomDocument.event,this._requestId=1,this._callbacks=new Map}static register(e){const t=new c(e);return n.window.registerCustomEditorProvider(c.viewType,t,{webviewOptions:{enableFindWidget:!0,retainContextWhenHidden:!0}})}saveCustomDocument(e,t){return e.save(t)}saveCustomDocumentAs(e,t,i){return e.saveAs(t,i)}revertCustomDocument(e,t){return e.revert(t)}backupCustomDocument(e,t,i){return e.backup(t.destination,i)}openCustomDocument(e,t,i){return r(this,void 0,void 0,(function*(){const i=yield h.create(e,t.backupId,{getFileData:()=>r(this,void 0,void 0,(function*(){let e=a.documentViewManager.find(i.uri).panel;const t=yield this.postMessageWithResponse(e,"getData",{});return new Uint8Array(t)}))}),n=[];return n.push(i.onDidChange((e=>{this._onDidChangeCustomDocument.fire(Object.assign({document:i},e))}))),n.push(i.onDidChangeDocument((e=>{for(const t of a.documentViewManager.filter(i.uri))t.panel.webview.postMessage({content:e.content})}))),i.onDidDispose((()=>(0,s.disposeAll)(n))),i}))}postMessageWithResponse(e,t,i){const r=this._requestId++,n=new Promise((e=>this._callbacks.set(r,e)));return e.webview.postMessage({type:t,requestId:r,body:i}),n}resolveCustomEditor(e,t,i){return r(this,void 0,void 0,(function*(){let i=new o.default(this.context,e.uri);i.panel=t,i.initialize(),i.enableEditing(e),t.webview.onDidReceiveMessage((e=>{if(e.response){const t=this._callbacks.get(e.requestId);null==t||t(e.body)}}))}))}}t.ExcelEditorProvider=c,c.viewType="gc-excelviewer-excel-editor";class h extends s.Disposable{constructor(e,t,i){super(),this._onDidDispose=this._register(new n.EventEmitter),this.onDidDispose=this._onDidDispose.event,this._onDidChangeDocument=this._register(new n.EventEmitter),this.onDidChangeDocument=this._onDidChangeDocument.event,this._onDidChange=this._register(new n.EventEmitter),this.onDidChange=this._onDidChange.event,this._uri=e,this._documentData=t,this._delegate=i}static create(e,t,i){return r(this,void 0,void 0,(function*(){const r="string"==typeof t?n.Uri.parse(t):e,s=yield h.readFile(r);return new h(e,s,i)}))}static readFile(e){return r(this,void 0,void 0,(function*(){return"untitled"===e.scheme?new Uint8Array:n.workspace.fs.readFile(e)}))}get uri(){return this._uri}get documentData(){return this._documentData}change(e){let t=a.documentViewManager.find(this.uri);this._onDidChange.fire({label:e,undo:()=>r(this,void 0,void 0,(function*(){return t.undo()})),redo:()=>r(this,void 0,void 0,(function*(){return t.redo()}))})}save(e){return r(this,void 0,void 0,(function*(){yield this.saveAs(this.uri,e)}))}saveAs(e,t){return r(this,void 0,void 0,(function*(){const i=yield this._delegate.getFileData();t.isCancellationRequested||(yield n.workspace.fs.writeFile(e,i))}))}revert(e){return r(this,void 0,void 0,(function*(){const e=yield h.readFile(this.uri);this._documentData=e,this._onDidChangeDocument.fire({content:e})}))}backup(e,t){return r(this,void 0,void 0,(function*(){return yield this.saveAs(e,t),{id:e.toString(),delete:()=>r(this,void 0,void 0,(function*(){try{yield n.workspace.fs.delete(e)}catch(e){}}))}}))}dispose(){this._onDidDispose.fire(),super.dispose()}}t.ExcelDocument=h},18:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(29);class n extends r.default{static revive(e,t,i){let r=new n(e,t);return r.scheme="csv-preview",r.attachWebviewPanel(i),r.initialize(),r}refresh(){}getHtml(e=!1){return'\n        <!DOCTYPE html>\n        <html>\n        <body>\n            <p>This preview was created with an earlier version of Excel Viewer, and cannot be restored.</p>\n            <p>Please close this tab and reopen the preview as you normally would.</p>\n            <p>Alternatively, you can open a custom editor as follows:</p>\n            <ul>\n            <li>For CSV files, right-click the filename and select <b>Open With</b>, then choose <b>CSV Viewer</b> when prompted.</li>\n            <li>For Excel files, double-click the filename to open the custom editor directly.</li>\n            </ul>\n            <p>Excel Viewer now supports <b>Visual Studio Code for the Web</b>. To get started, go to <a href="https://vscode.dev">https://vscode.dev</a>.</p>\n        </body>\n        </html>'}get viewType(){return"gc-excelviewer-csv"}get configurable(){return!1}}t.default=n},712:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLicenseKey=void 0,t.getLicenseKey=function(){return"GrapeCity-vscode-webview-only,835652139481543#B0MwIbBJye0ICRiwiI34zZ9kERwcVUwxWQvUHOmF4RHJnYZZWbYpXMBFXeJRjcntWQPZXVPVHTRpXaNN5Y7N4LrdTbINVMoFmT9olMI5WWVZ6L78ES9wmTLR5R4sCV82mNvVXOsNVcWV5c5sUW8ZVaz8GS6IWWxBDazhXNp3mUNBHU6hHUul4Vr9WUDdkTTRVbYBFRIVDUYJ4V7pkR7YzL5NWNkR6T844QSJjMwoXdGNFNPdTUjRlbadDRu9GOkVGa6B5UxwWcDZ5czYzSlF7SXBjSvRGdyJXdh34Sr3kNywma9E4KrY4MMVHOyIFRFZXR8hmSZFjMXlWMkVVdmFlYqJHWjRUWwk6NRpkUm9kbqhWZWJDOhhWd9kmVzY7cZZHZZVXTxgjZ6llVzckNp3WQzcTZy3UZiRWMQhlMKVmZ7YXeuJTOXZHNh3UVNdWO7sSd6U7MUtCUZVkTKdUcuRmZ6l5YjZlI0IyUiwiIEVDOGBjM4MjI0ICSiwCNxUjNxYDO9YTM0IicfJye35XX3JSSwIjUiojIDJCLi86bpNnblRHeFBCI4VWZoNFelxmRg2Wbql6ViojIOJyes4nI5kkTRJiOiMkIsIibvl6cuVGd8VEIgIXZ7VWaWRncvBXZSBybtpWaXJiOi8kI1xSfis4N8gkI0IyQiwiIu3Waz9WZ4hXRgAydvJVa4xWdNBybtpWaXJiOi8kI1xSfiQjR6QkI0IyQiwiIu3Waz9WZ4hXRgACUBx4TgAybtpWaXJiOi8kI1xSfiMzQwIkI0IyQiwiIlJ7bDBybtpWaXJiOi8kI1xSfiUFO7EkI0IyQiwiIu3Waz9WZ4hXRgACdyFGaDxWYpNmbh9WaGBybtpWaXJiOi8kI1tlOiQmcQJCLiYjM8ADOwAiNwkDMyIDMyIiOiQncDJCLiUjMzAzMyAjMiojIwhXRiwiI9RXaDVGchJ7RiojIh94QiwiIzQTNxgDN9MTMyUjN5MDOiojIklkIs4XXbpjInxmZiwiIyYnMyAjMiojIyVmdiwSZzxWYmpjIyNHZNsIO"}},825:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LegacySerializer=t.ExcelSerializer=t.CsvSerializer=void 0;const n=i(496),s=i(341),o=i(920),a=i(18);t.CsvSerializer=class{constructor(e){this._context=e}deserializeWebviewPanel(e,t){return r(this,void 0,void 0,(function*(){s.default.revive(this._context,n.Uri.parse(t.uri),e)}))}},t.ExcelSerializer=class{constructor(e){this._context=e}deserializeWebviewPanel(e,t){return r(this,void 0,void 0,(function*(){o.default.revive(this._context,n.Uri.parse(t.uri),e)}))}},t.LegacySerializer=class{constructor(e){this._context=e}deserializeWebviewPanel(e,t){return r(this,void 0,void 0,(function*(){a.default.revive(this._context,n.Uri.parse(t.uri),e)}))}}},373:(e,t,i)=>{"use strict";i.r(t),i.d(t,{URI:()=>s,Utils:()=>o});var r,n=i(155);r=(()=>{var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var i,r="",n=0,s=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)i=e.charCodeAt(a);else{if(47===i)break;i=47}if(47===i){if(s===a-1||1===o);else if(s!==a-1&&2===o){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){-1===c?(r="",n=0):n=(r=r.slice(0,c)).length-1-r.lastIndexOf("/"),s=a,o=0;continue}}else if(2===r.length||1===r.length){r="",n=0,s=a,o=0;continue}t&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+e.slice(s+1,a):r=e.slice(s+1,a),n=a-s-1;s=a,o=0}else 46===i&&-1!==o?++o:o=-1}return r}var r={resolve:function(){for(var e,r="",s=!1,o=arguments.length-1;o>=-1&&!s;o--){var a;o>=0?a=arguments[o]:(void 0===e&&(e=n.cwd()),a=e),t(a),0!==a.length&&(r=a+"/"+r,s=47===a.charCodeAt(0))}return r=i(r,!s),s?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!r)).length||r||(e="."),e.length>0&&n&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,i=0;i<arguments.length;++i){var n=arguments[i];t(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":r.normalize(e)},relative:function(e,i){if(t(e),t(i),e===i)return"";if((e=r.resolve(e))===(i=r.resolve(i)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var s=e.length,o=s-n,a=1;a<i.length&&47===i.charCodeAt(a);++a);for(var c=i.length-a,h=o<c?o:c,u=-1,l=0;l<=h;++l){if(l===h){if(c>h){if(47===i.charCodeAt(a+l))return i.slice(a+l+1);if(0===l)return i.slice(a+l)}else o>h&&(47===e.charCodeAt(n+l)?u=l:0===l&&(u=0));break}var d=e.charCodeAt(n+l);if(d!==i.charCodeAt(a+l))break;47===d&&(u=l)}var p="";for(l=n+u+1;l<=s;++l)l!==s&&47!==e.charCodeAt(l)||(0===p.length?p+="..":p+="/..");return p.length>0?p+i.slice(a+u):(a+=u,47===i.charCodeAt(a)&&++a,i.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var i=e.charCodeAt(0),r=47===i,n=-1,s=!0,o=e.length-1;o>=1;--o)if(47===(i=e.charCodeAt(o))){if(!s){n=o;break}}else s=!1;return-1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename:function(e,i){if(void 0!==i&&"string"!=typeof i)throw new TypeError('"ext" argument must be a string');t(e);var r,n=0,s=-1,o=!0;if(void 0!==i&&i.length>0&&i.length<=e.length){if(i.length===e.length&&i===e)return"";var a=i.length-1,c=-1;for(r=e.length-1;r>=0;--r){var h=e.charCodeAt(r);if(47===h){if(!o){n=r+1;break}}else-1===c&&(o=!1,c=r+1),a>=0&&(h===i.charCodeAt(a)?-1==--a&&(s=r):(a=-1,s=c))}return n===s?s=c:-1===s&&(s=e.length),e.slice(n,s)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){n=r+1;break}}else-1===s&&(o=!1,s=r+1);return-1===s?"":e.slice(n,s)},extname:function(e){t(e);for(var i=-1,r=0,n=-1,s=!0,o=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===n&&(s=!1,n=a+1),46===c?-1===i?i=a:1!==o&&(o=1):-1!==i&&(o=-1);else if(!s){r=a+1;break}}return-1===i||-1===n||0===o||1===o&&i===n-1&&i===r+1?"":e.slice(i,n)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var i=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+r:i+"/"+r:r}(0,e)},parse:function(e){t(e);var i={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return i;var r,n=e.charCodeAt(0),s=47===n;s?(i.root="/",r=1):r=0;for(var o=-1,a=0,c=-1,h=!0,u=e.length-1,l=0;u>=r;--u)if(47!==(n=e.charCodeAt(u)))-1===c&&(h=!1,c=u+1),46===n?-1===o?o=u:1!==l&&(l=1):-1!==o&&(l=-1);else if(!h){a=u+1;break}return-1===o||-1===c||0===l||1===l&&o===c-1&&o===a+1?-1!==c&&(i.base=i.name=0===a&&s?e.slice(1,c):e.slice(a,c)):(0===a&&s?(i.name=e.slice(1,o),i.base=e.slice(1,c)):(i.name=e.slice(a,o),i.base=e.slice(a,c)),i.ext=e.slice(o,c)),a>0?i.dir=e.slice(0,a-1):s&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r},447:(e,t,i)=>{var r;if(i.r(t),i.d(t,{URI:()=>w,Utils:()=>D}),"object"==typeof n)r="win32"===n.platform;else if("object"==typeof navigator){var s=navigator.userAgent;r=s.indexOf("Windows")>=0}var o,a,c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),h=/^\w[\w\d+.-]*$/,u=/^\//,l=/^\/\//;function d(e,t){if(!e.scheme&&t)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'.concat(e.authority,'", path: "').concat(e.path,'", query: "').concat(e.query,'", fragment: "').concat(e.fragment,'"}'));if(e.scheme&&!h.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!u.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(l.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}var p="",f="/",v=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,w=function(){function e(e,t,i,r,n,s){void 0===s&&(s=!1),"object"==typeof e?(this.scheme=e.scheme||p,this.authority=e.authority||p,this.path=e.path||p,this.query=e.query||p,this.fragment=e.fragment||p):(this.scheme=function(e,t){return e||t?e:"file"}(e,s),this.authority=t||p,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==f&&(t=f+t):t=f}return t}(this.scheme,i||p),this.query=r||p,this.fragment=n||p,d(this,s))}return e.isUri=function(t){return t instanceof e||!!t&&"string"==typeof t.authority&&"string"==typeof t.fragment&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.scheme&&"string"==typeof t.fsPath&&"function"==typeof t.with&&"function"==typeof t.toString},Object.defineProperty(e.prototype,"fsPath",{get:function(){return x(this,!1)},enumerable:!1,configurable:!0}),e.prototype.with=function(e){if(!e)return this;var t=e.scheme,i=e.authority,r=e.path,n=e.query,s=e.fragment;return void 0===t?t=this.scheme:null===t&&(t=p),void 0===i?i=this.authority:null===i&&(i=p),void 0===r?r=this.path:null===r&&(r=p),void 0===n?n=this.query:null===n&&(n=p),void 0===s?s=this.fragment:null===s&&(s=p),t===this.scheme&&i===this.authority&&r===this.path&&n===this.query&&s===this.fragment?this:new m(t,i,r,n,s)},e.parse=function(e,t){void 0===t&&(t=!1);var i=v.exec(e);return i?new m(i[2]||p,U(i[4]||p),U(i[5]||p),U(i[7]||p),U(i[9]||p),t):new m(p,p,p,p,p)},e.file=function(e){var t=p;if(r&&(e=e.replace(/\\/g,f)),e[0]===f&&e[1]===f){var i=e.indexOf(f,2);-1===i?(t=e.substring(2),e=f):(t=e.substring(2,i),e=e.substring(i)||f)}return new m("file",t,e,p,p)},e.from=function(e){var t=new m(e.scheme,e.authority,e.path,e.query,e.fragment);return d(t,!0),t},e.prototype.toString=function(e){return void 0===e&&(e=!1),C(this,e)},e.prototype.toJSON=function(){return this},e.revive=function(t){if(t){if(t instanceof e)return t;var i=new m(t);return i._formatted=t.external,i._fsPath=t._sep===g?t.fsPath:null,i}return t},e}(),g=r?1:void 0,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._formatted=null,t._fsPath=null,t}return c(t,e),Object.defineProperty(t.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=x(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(e){return void 0===e&&(e=!1),e?C(this,!0):(this._formatted||(this._formatted=C(this,!1)),this._formatted)},t.prototype.toJSON=function(){var e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=g),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e},t}(w),y=((a={})[58]="%3A",a[47]="%2F",a[63]="%3F",a[35]="%23",a[91]="%5B",a[93]="%5D",a[64]="%40",a[33]="%21",a[36]="%24",a[38]="%26",a[39]="%27",a[40]="%28",a[41]="%29",a[42]="%2A",a[43]="%2B",a[44]="%2C",a[59]="%3B",a[61]="%3D",a[32]="%20",a);function b(e,t){for(var i=void 0,r=-1,n=0;n<e.length;n++){var s=e.charCodeAt(n);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||t&&47===s)-1!==r&&(i+=encodeURIComponent(e.substring(r,n)),r=-1),void 0!==i&&(i+=e.charAt(n));else{void 0===i&&(i=e.substr(0,n));var o=y[s];void 0!==o?(-1!==r&&(i+=encodeURIComponent(e.substring(r,n)),r=-1),i+=o):-1===r&&(r=n)}}return-1!==r&&(i+=encodeURIComponent(e.substring(r))),void 0!==i?i:e}function _(e){for(var t=void 0,i=0;i<e.length;i++){var r=e.charCodeAt(i);35===r||63===r?(void 0===t&&(t=e.substr(0,i)),t+=y[r]):void 0!==t&&(t+=e[i])}return void 0!==t?t:e}function x(e,t){var i;return i=e.authority&&e.path.length>1&&"file"===e.scheme?"//".concat(e.authority).concat(e.path):47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,r&&(i=i.replace(/\//g,"\\")),i}function C(e,t){var i=t?_:b,r="",n=e.scheme,s=e.authority,o=e.path,a=e.query,c=e.fragment;if(n&&(r+=n,r+=":"),(s||"file"===n)&&(r+=f,r+=f),s){var h=s.indexOf("@");if(-1!==h){var u=s.substr(0,h);s=s.substr(h+1),-1===(h=u.indexOf(":"))?r+=i(u,!1):(r+=i(u.substr(0,h),!1),r+=":",r+=i(u.substr(h+1),!1)),r+="@"}-1===(h=(s=s.toLowerCase()).indexOf(":"))?r+=i(s,!1):(r+=i(s.substr(0,h),!1),r+=s.substr(h))}if(o){if(o.length>=3&&47===o.charCodeAt(0)&&58===o.charCodeAt(2))(l=o.charCodeAt(1))>=65&&l<=90&&(o="/".concat(String.fromCharCode(l+32),":").concat(o.substr(3)));else if(o.length>=2&&58===o.charCodeAt(1)){var l;(l=o.charCodeAt(0))>=65&&l<=90&&(o="".concat(String.fromCharCode(l+32),":").concat(o.substr(2)))}r+=i(o,!0)}return a&&(r+="?",r+=i(a,!1)),c&&(r+="#",r+=t?c:b(c,!1)),r}function E(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+E(e.substr(3)):e}}var j=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function U(e){return e.match(j)?e.replace(j,(function(e){return E(e)})):e}var D,S=i(470),O=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,s=t.length;n<s;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},I=S.posix||S;!function(e){e.joinPath=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.with({path:I.join.apply(I,O([e.path],t,!1))})},e.resolvePath=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=e.path||"/";return e.with({path:I.resolve.apply(I,O([r],t,!1))})},e.dirname=function(e){var t=I.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)?e:e.with({path:t})},e.basename=function(e){return I.basename(e.path)},e.extname=function(e){return I.extname(e.path)}}(D||(D={}))}},t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}return i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(447)})();const{URI:s,Utils:o}=r},496:e=>{"use strict";e.exports=require("vscode")}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=i(496),n=i(341),s=i(920),o=i(371),a=i(373),c=i(825),h=i(516),u=i(646);function l(e){return!(!t.workspace.getConfiguration("csv-preview").get("openStdin")||!e)&&a.Utils.basename(e.uri).match("code-stdin-[^.]+.txt")}function d(){const e=t.window.activeTextEditor;return e?e.viewColumn:t.ViewColumn.One}e.activate=function(e){let i=t.commands.registerCommand("csv.preview",(i=>{let r=i,s=d();if(!(r instanceof t.Uri)){if(!t.window.activeTextEditor)return void t.window.showInformationMessage("Open a CSV file first to show a preview.");r=t.window.activeTextEditor.document.uri,s=t.window.activeTextEditor.viewColumn}const a=r.with({scheme:"csv-preview"});let c=o.documentViewManager.find(a);if(!c)return c=n.default.create(e,r,s),c.webview;c.reveal()})),r=t.commands.registerCommand("excel.preview",(i=>{let r=i,n=d();if(!(r instanceof t.Uri))return void t.window.showInformationMessage("Use the explorer context menu or editor title menu to preview Excel files.");const a=r.with({scheme:"excel-preview"});let c=o.documentViewManager.find(a);if(!c)return c=s.default.create(e,r,n),c.webview;c.reveal()})),a=t.commands.registerCommand("csv.clearState",(()=>{let e=o.documentViewManager.active();e&&e.clearState()})),p=t.commands.registerCommand("csv.refresh",(()=>{let e=o.documentViewManager.active();e&&e.refresh()}));if(e.subscriptions.push(i),e.subscriptions.push(r),e.subscriptions.push(a),e.subscriptions.push(p),e.subscriptions.push(h.CsvEditorProvider.register(e)),e.subscriptions.push(u.ExcelEditorProvider.register(e)),t.window.registerWebviewPanelSerializer("gc-excelviewer-csv",new c.LegacySerializer(e)),t.window.registerWebviewPanelSerializer("gc-excelviewer-excel",new c.LegacySerializer(e)),t.window.registerWebviewPanelSerializer("gc-excelviewer-csv-preview",new c.CsvSerializer(e)),t.window.registerWebviewPanelSerializer("gc-excelviewer-excel-preview",new c.ExcelSerializer(e)),t.workspace.onDidChangeConfiguration((()=>{o.documentViewManager.configure()})),t.workspace.onDidOpenTextDocument((e=>{l(e)&&t.commands.executeCommand("csv.preview",e.uri)})),t.window.activeTextEditor){let e=t.window.activeTextEditor.document;l(e)&&t.commands.executeCommand("csv.preview",e.uri)}},e.deactivate=function(){}})(),module.exports=r})();
//# sourceMappingURL=extension.js.map